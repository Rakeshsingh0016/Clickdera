<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gemini AI Chat</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #e5ddd5;
    display: flex;
    justify-content: center;
    padding: 2rem;
  }

  .chat-container {
    width: 100%;
    max-width: 600px;
    background: #f7f7f7;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .messages {
    padding: 1rem;
    flex: 1;
    overflow-y: auto;
    max-height: 400px;
  }

  .message {
    margin-bottom: 10px;
    display: flex;
    flex-wrap: wrap;
  }

  .message.user {
    justify-content: flex-end;
  }

  .message.ai {
    justify-content: flex-start;
  }

  .message .bubble {
    padding: 10px 15px;
    border-radius: 20px;
    max-width: 80%;
    line-height: 1.4;
  }

  .message.user .bubble {
    background: #0084ff;
    color: #fff;
    border-bottom-right-radius: 0;
  }

  .message.ai .bubble {
    background: #f1f0f0;
    color: #000;
    border-bottom-left-radius: 0;
  }

  .input-container {
    display: flex;
    padding: 10px;
    background: #ddd;
  }

  .input-container textarea {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    border-radius: 20px;
    border: none;
    resize: none;
    outline: none;
  }

  .input-container button {
    margin-left: 10px;
    padding: 0 20px;
    border: none;
    border-radius: 20px;
    background: #0084ff;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.2s;
  }

  .input-container button:hover {
    background: #006bbd;
  }
</style>
</head>
<body>

<div class="chat-container">
  <div class="messages" id="messages"></div>
  <div class="input-container">
    <textarea id="prompt" rows="1" placeholder="Type a message..."></textarea>
    <button id="sendBtn">Send</button>
  </div>
</div>

<script>
const sendBtn = document.getElementById('sendBtn');
const promptInput = document.getElementById('prompt');
const messagesDiv = document.getElementById('messages');

function addMessage(text, sender) {
  const msgDiv = document.createElement('div');
  msgDiv.classList.add('message', sender);

  const bubble = document.createElement('div');
  bubble.classList.add('bubble');
  bubble.textContent = text;

  msgDiv.appendChild(bubble);
  messagesDiv.appendChild(msgDiv);

  // Auto scroll
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

sendBtn.addEventListener('click', async () => {
  const prompt = promptInput.value.trim();
  if (!prompt) return;

  addMessage(prompt, 'user');
  promptInput.value = '';
  
  addMessage('Typing...', 'ai');

  try {
    const res = await fetch('https://gemini-backend-alpha-dusky.vercel.app/api/gemini', { 
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt })
    });

    const data = await res.json();
    
    // Replace 'Typing...' with actual reply
    const aiMessages = messagesDiv.querySelectorAll('.message.ai');
    aiMessages[aiMessages.length - 1].querySelector('.bubble').textContent = data.reply || "No reply from server";

  } catch (err) {
    const aiMessages = messagesDiv.querySelectorAll('.message.ai');
    aiMessages[aiMessages.length - 1].querySelector('.bubble').textContent = "Server error: " + err.message;
  }
});

// Allow Enter key to send
promptInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendBtn.click();
  }
});
</script>

</body>
</html>
